<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="DashCam App - Превратите свой Android-телефон в профессиональный видеорегистратор">
    <title>DashCam App - Руководство пользователя</title>
    <link rel="icon" type="image/png" sizes="192x192" href="../../images/app-icon-192.png">
    <link rel="icon" type="image/png" sizes="96x96" href="../../images/app-icon-96.png">
    <link rel="icon" type="image/png" sizes="48x48" href="../../images/app-icon-48.png">
    <link rel="apple-touch-icon" href="../../images/app-icon-192.png">
    <link rel="stylesheet" href="../../styles.css">
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <img src="../../images/app-icon-96.png" alt="Иконка приложения DashCam" class="app-icon">
                <div class="header-text">
                    <h1>DashCam App — Руководство пользователя</h1>
                    <p class="subtitle">Версия 1.0.0 Beta | Android 8.0+ (API 26+) | Последнее обновление: 30 октября 2025</p>
                </div>
            </div>
        </div>
    </header>

    <nav>
        <ul>
            <li><a href="manual.html"  class="active">Руководство пользователя</a></li>
            <li><a href="eula.html">Условия использования</a></li>
            <li><a href="license.html">Лицензия</a></li>
            <li><a href="privacy-policy.html">Политика конфиденциальности</a></li>
        </ul>
    </nav>

    <div class="container">
        <section id="quick-start">
            <h2>Быстрый старт</h2>
            <ol>
                <li><strong>Установка и запуск:</strong> Предоставьте разрешения на доступ к камере, микрофону и местоположению при появлении запроса.</li>
                <li><strong>Установка телефона:</strong> Надежно закрепите устройство на лобовом стекле в горизонтальной ориентации, задней камерой вперед.</li>
                <li><strong>Подключение питания:</strong> Подключите к источнику питания, который включается вместе с зажиганием автомобиля (ACC). Приложение автоматически начинает запись при обнаружении питания и останавливает при его отключении.</li>
                <li><strong>Хранилище:</strong> Видео по умолчанию сохраняются во внутренней памяти. Вы можете изменить место хранения на SD-карту или внешнее хранилище в настройках.</li>
                <li><strong>Загрузка (по желанию):</strong> Настройте загрузку на домашний компьютер, NAS или облачное хранилище (Google Drive, OneDrive) через Wi-Fi.</li>
            </ol>
        </section>

        <hr>

        <section id="introduction">
            <h2>Введение</h2>
            <p>DashCam превращает старый Android-телефон в надежный полнофункциональный видеорегистратор для автомобиля. Разработанный с акцентом на <strong>стабильность, автоматизацию и простоту</strong>, он автоматически записывает при запуске автомобиля и сохраняет или загружает записи при остановке.</p>

            <h3>Основные возможности</h3>
            <ul>
                <li><strong>Автоматическая запись</strong>, привязанная к зажиганию или обнаружению удара</li>
                <li><strong>Обнаружение ударов</strong> с кольцевым видеобуфером (сохраняет 2 мин. до + 10 сек. после)</li>
                <li><strong>Полная телеметрия:</strong> GPS, скорость и запись с 6-осевого датчика движения</li>
                <li><strong>Гибкая загрузка:</strong> общая папка Windows (SMB/CIFS) или облако (Google Drive, OneDrive)</li>
                <li><strong>Множество форматов вывода:</strong> MP4-видео, SRT-субтитры, CSV с данными датчиков, GPX-треки</li>
                <li><strong>Автоматическое управление хранилищем:</strong> настраиваемая автоочистка при нехватке места</li>
                <li><strong>Загрузка через очередь:</strong> автоматический повтор с фоновой обработкой</li>
                <li><strong>Безопасные учетные данные:</strong> зашифрованное хранение через Android Keystore</li>
                <li><strong>Поддержка NetBIOS:</strong> используйте имена хостов Windows вместо IP-адресов</li>
                <li><strong>Оптимизация батареи:</strong> разработано для непрерывной работы с минимальным энергопотреблением</li>
                <li><strong>Работа без вмешательства:</strong> установите один раз, используйте ежедневно — взаимодействие не требуется</li>
            </ul>
        </section>

        <hr>

        <section id="getting-started">
            <h2>Начало работы</h2>

            <h3>Разрешения</h3>
            <p>Предоставьте эти разрешения при первом запуске:</p>
            <ul>
                <li><strong>Камера</strong> – необходима для видеозаписи.</li>
                <li><strong>Микрофон</strong> – для захвата аудио в записях.</li>
                <li><strong>Местоположение</strong> – для GPS-координат, записи скорости и определения SSID Wi-Fi (ограничения загрузки).</li>
                <li><strong>Хранилище</strong> – (Android 9 и ниже) для сохранения записей на устройстве.</li>
            </ul>

            <h3>Оптимизация батареи</h3>
            <p>DashCam запросит <strong>исключение из оптимизации батареи</strong> при первом запуске. Это позволяет приложению:</p>
            <ul>
                <li>Продолжать запись при выключенном экране</li>
                <li>Завершать загрузки после отключения питания</li>
                <li>Отслеживать удары в режиме AUTO</li>
            </ul>
            <p>Вы можете проверить статус оптимизации батареи в <strong>Настройки → Системные настройки</strong>.</p>

            <h3>Установка телефона</h3>
            <ul>
                <li>Используйте <strong>крепление на лобовое стекло или панель приборов</strong> со стабильным видом вперед.</li>
                <li>Аккуратно уложите кабели, чтобы они не мешали обзору.</li>
                <li>Подключите питание от зарядного устройства, подключенного к зажиганию (ACC), для автоматической работы.</li>
            </ul>

            <h3>Поведение при питании</h3>
            <ul>
                <li><strong>Зажигание включено (питание подключено):</strong> запись начинается автоматически.</li>
                <li><strong>Зажигание выключено (питание отключено):</strong> запись безопасно останавливается, и начинается загрузка (если настроена). Телефон остается активным для завершения загрузок, затем переходит в спящий режим для экономии энергии.</li>
            </ul>
        </section>

        <hr>

        <section id="main-screen">
            <h2>Главный экран</h2>

            <h3>Расположение элементов</h3>
            <ul>
                <li><strong>Вверху слева:</strong> текущая дата и время (формат настраивается в настройках)</li>
                <li><strong>Вверху справа:</strong> кнопка настроек + индикатор состояния загрузки</li>
                <li><strong>Внизу слева:</strong> GPS-координаты, направление по компасу и статус записи</li>
                <li><strong>Внизу справа:</strong> текущая скорость (миль/ч или км/ч, настраивается)</li>
                <li><strong>По центру:</strong> предпросмотр с камеры в реальном времени</li>
                <li><strong>Справа по центру:</strong> кнопка ручной записи (FAB)</li>
            </ul>

            <h3>Индикаторы состояния</h3>
            <ul>
                <li><strong>REC (красная рамка):</strong> в данный момент идет видеозапись</li>
                <li><strong>AUTO (зеленая рамка):</strong> буфер режима AUTO работает (ожидает удара)</li>
                <li><strong>Кнопка ручной записи:</strong>
                    <ul>
                        <li>Красный круг (⏺) = запись не ведется, нажмите для начала</li>
                        <li>Белый квадрат (⏹) = идет запись, нажмите для остановки</li>
                    </ul>
                </li>
            </ul>

            <h3>Индикаторы загрузки (вверху справа)</h3>
            <ul>
                <li><strong>Зеленая иконка загрузки (⏫):</strong> выполняются активные загрузки (показывает количество)</li>
                <li><strong>Оранжевая иконка паузы (⏸):</strong> загрузки приостановлены (показывает количество, нажмите для открытия просмотрщика очереди)</li>
                <li><strong>Красная иконка предупреждения (⚠️):</strong> ошибки загрузки (показывает количество, нажмите для просмотра ошибок)</li>
            </ul>

            <div class="alert alert-warning">
                <p><strong>Примечание:</strong> Если вы видите "EMULATOR – Video recording disabled", вы работаете в эмуляторе Android. Видеозапись требует физического устройства с камерой.</p>
            </div>
        </section>

        <hr>

        <section id="recording-modes">
            <h2>Режимы записи</h2>

            <h3>1. AUTO (обнаружение удара)</h3>
            <p>Идеально для повседневного вождения — экономит место, сохраняя только важные моменты.</p>
            <ul>
                <li>Записывает непрерывные 1-минутные сегменты в кольцевой буфер</li>
                <li>Хранит только последние 2 минуты в памяти (гарантированно 30+ секунд до удара)</li>
                <li>При обнаружении удара акселерометром DashCam:
                    <ul>
                        <li>Сохраняет 2-минутный буфер (до удара)</li>
                        <li>Записывает еще 10 секунд (после удара)</li>
                        <li>Сохраняет полную запись со всеми данными телеметрии</li>
                    </ul>
                </li>
                <li><strong>Чувствительность к удару:</strong> ВЫСОКАЯ (1.5G), СРЕДНЯЯ (2.0G, по умолчанию), НИЗКАЯ (3.0G)</li>
                <li><strong>Имя файла:</strong> <code>DashCam-20250115-143022-Impact.mp4</code></li>
                <li><strong>Поведение при питании:</strong> игнорирует события питания (реагирует только на удары)</li>
            </ul>

            <h3>2. PER_TRIP (за поездку)</h3>
            <p>Одна непрерывная запись на цикл питания — идеально для полной документации поездки.</p>
            <ul>
                <li>Начинается автоматически при подключении питания (включении зажигания)</li>
                <li>Останавливается при отключении питания (выключении зажигания)</li>
                <li>Настраиваемая задержка защиты от дребезга (0-60 секунд, по умолчанию 10 с) предотвращает остановки при кратковременных скачках питания</li>
                <li>Автоматическая нумерация поездок: сканирует существующие файлы, чтобы избежать дубликатов</li>
                <li><strong>Имя файла:</strong> <code>DashCam-20250115-Trip01.mp4</code></li>
            </ul>

            <h3>3. Циклическая по времени (5/10/30 минут)</h3>
            <p>Разбивает записи на сегменты фиксированной длины для более удобного управления и загрузки.</p>
            <ul>
                <li>Создает новый сегмент каждые 5, 10 или 30 минут</li>
                <li>Выравнивается по границам часов (например, 10-мин. режим: :00, :10, :20, :30, :40, :50)</li>
                <li>Автоматически перезапускает следующий сегмент до отключения питания</li>
                <li>Идеально для баланса между размером файла и удобством загрузки</li>
                <li><strong>Имя файла:</strong> <code>DashCam-20250115-1430.mp4</code> (округлено до границы сегмента)</li>
            </ul>

            <h3>4. Ручная</h3>
            <p>Полный контроль — записывайте когда захотите.</p>
            <ul>
                <li>Нажмите кнопку с красным кругом для начала записи</li>
                <li>Нажмите кнопку с белым квадратом для остановки записи</li>
                <li>Доступна независимо от состояния питания или других настроек</li>
                <li>Не зависит от автоматических режимов записи</li>
            </ul>

            <div class="alert alert-tip">
                <p><strong>Совет:</strong> Вы можете использовать ручную запись в любое время, даже когда режим AUTO работает в фоновом режиме.</p>
            </div>
        </section>

        <hr>

        <section id="settings">
            <h2>Обзор настроек</h2>

            <h3>Настройки отображения</h3>
            <ul>
                <li><strong>Единицы скорости:</strong> миль/ч или км/ч</li>
                <li><strong>Формат даты:</strong> ММ/ДД/ГГГГ, ДД/ММ/ГГГГ или ГГГГ-ММ-ДД</li>
                <li><strong>Формат времени:</strong> 12-часовой или 24-часовой</li>
                <li><strong>Не выключать экран:</strong> предотвращает тайм-аут экрана во время записи</li>
            </ul>

            <h3>Настройки видео</h3>
            <ul>
                <li><strong>Качество видео:</strong>
                    <ul>
                        <li>720p (50 МБ/мин) — длительные поездки, ограниченное хранилище</li>
                        <li>1080p (80 МБ/мин, по умолчанию) — сбалансированное качество</li>
                        <li>2160p/4K (200 МБ/мин) — максимальная детализация, требуется большое хранилище</li>
                    </ul>
                </li>
            </ul>

            <h3>Настройки записи</h3>
            <ul>
                <li><strong>Режим записи:</strong> AUTO, PER_TRIP, 5MIN, 10MIN, 30MIN</li>
                <li><strong>Чувствительность к удару:</strong> ВЫСОКАЯ (1.5G), СРЕДНЯЯ (2.0G, по умолчанию), НИЗКАЯ (3.0G)
                    <br><em>Отображается только в режиме AUTO</em>
                </li>
                <li><strong>Место хранения:</strong> ВНУТРЕННЕЕ или ВНЕШНЕЕ (SD-карта/USB)</li>
                <li><strong>Выбрать пользовательскую папку:</strong> выберите путь к внешнему хранилищу (средство выбора папки SAF)</li>
            </ul>

            <h3>Настройки загрузки</h3>
            <ul>
                <li><strong>Включить автозагрузку:</strong> переключатель автоматической загрузки после записи</li>
                <li><strong>Разрешить лимитные подключения:</strong> включить загрузки через мобильную сеть (по умолчанию: только Wi-Fi)</li>
                <li><strong>Удалять после загрузки:</strong> автоматически удалять локальные файлы после успешной загрузки</li>
                <li><strong>Просмотр очереди загрузки:</strong> отслеживание и управление очередью загрузки</li>
                <li><strong>Назначение загрузки:</strong> SMB, Google Drive или OneDrive</li>
                <li><strong>Конфигурация назначения:</strong> см. подробные разделы ниже для каждого типа</li>
            </ul>

            <h3>Управление хранилищем</h3>
            <ul>
                <li><strong>Автоуправление хранилищем:</strong> автоматически удалять старые записи при нехватке места (по умолчанию: включено)</li>
                <li><strong>Целевое свободное место:</strong> настраиваемый порог 1-20 ГБ (по умолчанию: 5 ГБ)
                    <ul>
                        <li>Уровень ПРЕДУПРЕЖДЕНИЯ: менее 3 ГБ свободно</li>
                        <li>КРИТИЧЕСКИЙ уровень: менее 2 ГБ свободно</li>
                    </ul>
                </li>
                <li><strong>Статус в реальном времени:</strong> отображение текущего свободного места с цветовыми предупреждениями</li>
            </ul>

            <h3>Управление питанием</h3>
            <ul>
                <li><strong>Защита от дребезга при отключении питания:</strong> задержка перед остановкой при потере питания (0-60 секунд, по умолчанию 10 с)
                    <br><em>Предотвращает остановку записи при кратковременных скачках питания</em>
                </li>
            </ul>

            <h3>Системные настройки</h3>
            <ul>
                <li><strong>Статус оптимизации батареи:</strong> показывает, освобождено ли приложение от оптимизации батареи</li>
                <li><strong>Открыть настройки батареи:</strong> прямая ссылка на настройки оптимизации батареи Android</li>
            </ul>

            <h3>Правовая информация и документация</h3>
            <ul>
                <li>Руководство пользователя (этот документ)</li>
                <li>Лицензионное соглашение с конечным пользователем (EULA)</li>
                <li>Лицензия на программное обеспечение</li>
                <li>Политика конфиденциальности</li>
            </ul>
        </section>

        <hr>

        <section id="storage">
            <h2>Управление хранилищем</h2>

            <h3>Расположение по умолчанию</h3>
            <code>/Android/data/com.dashcam.app/files/DashCam/</code>
            <p>Это хранилище для конкретного приложения, доступное без специальных разрешений на Android 10+.</p>

            <h3>Внешнее хранилище или SD-карта</h3>
            <ol>
                <li>Перейдите в <strong>Настройки → Настройки записи → Место хранения</strong>.</li>
                <li>Выберите <strong>ВНЕШНЕЕ</strong>.</li>
                <li>Нажмите <strong>Выбрать пользовательскую папку</strong> и выберите путь к вашей SD-карте или USB-хранилищу.</li>
                <li>Предоставьте разрешение при запросе (Storage Access Framework).</li>
            </ol>
            <div class="alert alert-tip">
                <p><strong>Совет:</strong> Внешнее хранилище идеально подходит для SD-карт или USB-накопителей большой емкости. Убедитесь, что устройство хранения остается подключенным во время записи.</p>
            </div>

            <h3>Форматы файлов и вывод</h3>
            <p>Каждая запись создает <strong>четыре синхронизированных файла</strong>:</p>
            <ul>
                <li><strong>.mp4</strong> — H.264-видео со звуком (30 fps)</li>
                <li><strong>.srt</strong> — субтитры SubRip с GPS, скоростью, датой/временем (интервалы в 1 секунду)</li>
                <li><strong>.csv</strong> — данные датчиков: акселерометр, гироскоп, магнитометр, освещенность, давление, близость (частота 10 Гц)</li>
                <li><strong>.gpx</strong> — GPS-трек в формате GPX 1.1 XML (совместим с картографическим ПО)</li>
            </ul>

            <h3>Размеры файлов (приблизительно)</h3>
            <table>
                <thead>
                    <tr>
                        <th>Качество</th>
                        <th>МБ/мин</th>
                        <th>1-часовая запись</th>
                        <th>Рекомендуемое использование</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>720p</td>
                        <td>50</td>
                        <td>~3 ГБ</td>
                        <td>Длительные поездки, ограниченное хранилище</td>
                    </tr>
                    <tr>
                        <td>1080p</td>
                        <td>80</td>
                        <td>~4.8 ГБ</td>
                        <td>Сбалансированное качество (по умолчанию)</td>
                    </tr>
                    <tr>
                        <td>2160p/4K</td>
                        <td>200</td>
                        <td>~12 ГБ</td>
                        <td>Максимальная детализация, большое хранилище</td>
                    </tr>
                    <tr>
                        <td>Телеметрия</td>
                        <td>&lt;0.2</td>
                        <td>&lt;12 МБ</td>
                        <td>Все режимы (незначительно)</td>
                    </tr>
                </tbody>
            </table>

            <h3>Автоматическое управление хранилищем</h3>
            <p>Когда <strong>Автоуправление хранилищем</strong> включено (по умолчанию), DashCam автоматически удаляет старые записи, когда свободное место опускается ниже настроенного порога.</p>
            <ul>
                <li><strong>Порог по умолчанию:</strong> 5 ГБ свободного места</li>
                <li><strong>Настраиваемый диапазон:</strong> 1-20 ГБ</li>
                <li><strong>Поведение при удалении:</strong> удаляет полные наборы записей (все 4 файла вместе), начиная с самых старых</li>
                <li><strong>Уровни предупреждений:</strong> визуальные оповещения при менее 3 ГБ (ПРЕДУПРЕЖДЕНИЕ) или 2 ГБ (КРИТИЧНО)</li>
            </ul>
            <div class="alert alert-warning">
                <p><strong>Важно:</strong> Если вы отключите автоуправление, следите за хранилищем вручную, чтобы предотвратить сбои записи.</p>
            </div>
        </section>

        <hr>

        <section id="uploads">
            <h2>Настройка загрузки</h2>
            <p>DashCam поддерживает автоматическую загрузку в <strong>общую папку Windows <small>(SMB/CIFS)</small></strong>, <strong>Google Drive</strong> и <strong>OneDrive</strong>. Система загрузки на основе очереди включает автоматический повтор, фоновую обработку и мониторинг в реальном времени.</p>

            <h3>Триггеры загрузки</h3>
            <p>Загрузки могут запускаться тремя способами:</p>
            <ol>
                <li><strong>Автоматически (после записи):</strong> при включенной автозагрузке записи загружаются сразу после завершения</li>
                <li><strong>Ручная постановка всех в очередь:</strong> переключитесь с ВРУЧНУЮ на режим автозагрузки, чтобы поставить все существующие записи в очередь</li>
                <li><strong>Фоновый повтор:</strong> неудавшиеся загрузки автоматически повторяются с экспоненциальной задержкой (30 с, 60 с, 120 с, 240 с, 480 с)</li>
            </ol>

            <h3>Требования к сети</h3>
            <ul>
                <li><strong>Рекомендуется Wi-Fi:</strong> по умолчанию загрузки происходят только через сети Wi-Fi</li>
                <li><strong>Разрешить лимитные:</strong> включите эту настройку, чтобы разрешить загрузки через мобильную сеть (может взиматься плата за данные)</li>
                <li><strong>Активное подключение:</strong> устройство должно иметь интернет-соединение во время загрузки</li>
            </ul>

            <h3>Просмотрщик очереди загрузки</h3>
            <p>Откройте Просмотрщик очереди из <strong>Настройки → Настройки загрузки → Просмотрщик очереди загрузки</strong>, чтобы:</p>
            <ul>
                <li><strong>Отслеживать прогресс:</strong> статус загрузки в реальном времени с индикаторами прогресса</li>
                <li><strong>Пауза/возобновление:</strong> управление обработкой загрузок (состояние сохраняется при перезапуске приложения)</li>
                <li><strong>Повтор ошибок:</strong> вручную повторять неудавшиеся загрузки</li>
                <li><strong>Просмотр истории:</strong> просматривать ранее загруженные записи</li>
                <li><strong>Повторная загрузка:</strong> повторно загружать ранее успешные файлы при необходимости</li>
                <li><strong>Очистить очередь:</strong> удалить все элементы очереди и пересканировать хранилище</li>
            </ul>

            <h3>Состояния очереди</h3>
            <ul>
                <li><strong>IDLE:</strong> в очереди, ожидает загрузки</li>
                <li><strong>UPLOADING:</strong> в данный момент передается</li>
                <li><strong>ERROR:</strong> не удалось (останавливает очередь, требуется ручной повтор)</li>
                <li><strong>DONE:</strong> успешно загружено (хранится в истории)</li>
            </ul>

            <hr>

            <h3>Настройка общей папки Windows <small>(SMB/CIFS)</small></h3>
            <p>Загружайте записи на домашний компьютер, NAS или сервер Windows.</p>

            <h4>Шаги настройки</h4>
            <ol>
                <li>В настройках установите <strong>Тип назначения загрузки</strong> на <strong>Сетевая папка</strong></li>
                <li>Настройте данные подключения:
                    <ul>
                        <li><strong>Хост:</strong> имя хоста Windows (например, <code>MYPC</code>) или IP-адрес (например, <code>192.168.1.100</code>)</li>
                        <li><strong>Имя общего ресурса:</strong> имя SMB-ресурса (например, <code>dashcam</code>)</li>
                        <li><strong>Путь:</strong> необязательная подпапка в общем ресурсе (например, <code>recordings/2025</code>)</li>
                        <li><strong>Имя пользователя:</strong> имя пользователя локальной учетной записи Windows (необязательно для гостевого доступа)</li>
                        <li><strong>Пароль:</strong> пароль учетной записи (зашифрован через Android Keystore)</li>
                    </ul>
                </li>
                <li><strong>Ограничения сети Wi-Fi:</strong> необязательно ограничьте загрузки определенными SSID Wi-Fi (разделенные запятыми)</li>
                <li>Включите <strong>Автозагрузку</strong> в настройках</li>
            </ol>

            <h4>Разрешение имен хостов NetBIOS</h4>
            <p>DashCam поддерживает <strong>разрешение имен NetBIOS</strong>, позволяя использовать имена компьютеров Windows вместо IP-адресов.</p>
            <ul>
                <li><strong>Требования:</strong> оба устройства в одной сети Wi-Fi, включено сетевое обнаружение Windows</li>
                <li><strong>Пример:</strong> используйте <code>DESKTOP-ABC123</code> вместо <code>192.168.1.100</code></li>
                <li><strong>Резервный вариант:</strong> если имя хоста не работает, используйте IP-адрес (найдите через <code>ipconfig</code> в командной строке)</li>
            </ul>
            <blockquote><em>Примечание: NetBIOS в основном работает с сетями Windows. Пользователям macOS/Linux следует использовать IP-адреса.</em></blockquote>

            <h4>Создание локальной учетной записи Windows</h4>
            <p>Windows 10+ требует аутентифицированного доступа (без гостевых общих ресурсов):</p>
            <ol>
                <li>Нажмите <strong>Win + I</strong> → <strong>Учетные записи</strong> → <strong>Семья и другие пользователи</strong></li>
                <li>Нажмите <strong>Добавить пользователя для этого компьютера</strong></li>
                <li>Выберите <strong>У меня нет данных для входа этого пользователя</strong></li>
                <li>Выберите <strong>Добавить пользователя без учетной записи Microsoft</strong></li>
                <li>Создайте имя пользователя (например, <code>dashcam</code>) и пароль</li>
                <li>Щелкните правой кнопкой мыши на общей папке → <strong>Свойства</strong> → вкладка <strong>Доступ</strong> → <strong>Общий доступ</strong></li>
                <li>Добавьте нового пользователя с разрешениями <strong>Чтение/Запись</strong></li>
                <li>Также проверьте вкладку <strong>Безопасность</strong> и предоставьте разрешения Чтение/Запись там</li>
            </ol>

            <h4>Ограничения SSID Wi-Fi (только SMB)</h4>
            <p>Предотвратите загрузки через общедоступный Wi-Fi, ограничив определенные сети:</p>
            <ul>
                <li><strong>Настройка:</strong> Загружать только в сетях (SSID через запятую)</li>
                <li><strong>Пример:</strong> <code>HomeWiFi,Office5G</code></li>
                <li><strong>Поведение:</strong> если настроены SSID, загрузки происходят только при подключении к указанным сетям</li>
                <li><strong>Автодобавление:</strong> приложение автоматически добавляет текущий SSID при первой настройке SMB</li>
                <li><strong>Пусто = Любая сеть:</strong> оставьте пустым, чтобы разрешить загрузки в любой сети Wi-Fi</li>
            </ul>
            <div class="alert alert-warning">
                <p><strong>Примечание:</strong> Ограничения SSID применяются <strong>только к назначениям SMB</strong>. Загрузки в Google Drive и OneDrive работают в любой сети (интернет-сервисы).</p>
            </div>

            <hr>

            <h3>Настройка Google Drive</h3>
            <p>Загружайте записи напрямую в свою учетную запись Google Drive.</p>

            <h4>Шаги настройки</h4>
            <ol>
                <li>В настройках установите <strong>Тип назначения загрузки</strong> на <strong>Google Drive</strong></li>
                <li>Нажмите <strong>Подключить учетную запись Google</strong></li>
                <li>Выберите свою учетную запись Google из нативного средства выбора учетной записи</li>
                <li>Авторизуйте DashCam для доступа к Google Drive (разрешение Files.ReadWrite)</li>
                <li>Настройте структуру папок:
                    <ul>
                        <li><strong>Корневая папка:</strong> имя основной папки (например, <code>DashCam</code>) - создается автоматически, если не существует</li>
                        <li><strong>Подпапка:</strong> необязательный путь подпапки (например, <code>2025/January</code>)</li>
                    </ul>
                </li>
                <li>Включите <strong>Автозагрузку</strong> в настройках</li>
            </ol>

            <h4>Методы загрузки</h4>
            <ul>
                <li><strong>Многочастная загрузка:</strong> файлы менее 5 МБ загружаются одним запросом</li>
                <li><strong>Возобновляемая загрузка:</strong> файлы от 5 МБ и больше загружаются фрагментами по 5 МБ (можно возобновить при прерывании)</li>
            </ul>

            <h4>Аутентификация и безопасность</h4>
            <ul>
                <li><strong>OAuth 2.0:</strong> стандартная безопасная аутентификация промышленного уровня</li>
                <li><strong>Хранение токенов:</strong> зашифровано через Android Keystore (с аппаратной поддержкой, если доступно)</li>
                <li><strong>Автообновление:</strong> токены автоматически обновляются за 5 минут до истечения срока</li>
                <li><strong>Отключение:</strong> нажмите "Отключить учетную запись Google", чтобы отозвать доступ и очистить токены</li>
            </ul>

            <hr>

            <h3>Настройка OneDrive</h3>
            <p>Загружайте записи в свою учетную запись Microsoft OneDrive.</p>

            <h4>Шаги настройки</h4>
            <ol>
                <li>В настройках установите <strong>Тип назначения загрузки</strong> на <strong>OneDrive</strong></li>
                <li>Нажмите <strong>Подключить учетную запись Microsoft</strong></li>
                <li>Войдите через веб-поток OAuth 2.0 Microsoft (открывается в WebView)</li>
                <li>Авторизуйте DashCam для доступа к OneDrive (разрешение Files.ReadWrite)</li>
                <li>Настройте структуру папок:
                    <ul>
                        <li><strong>Корневая папка:</strong> имя основной папки (например, <code>DashCam</code>) - создается автоматически, если не существует</li>
                        <li><strong>Подпапка:</strong> необязательный путь подпапки (например, <code>2025/January</code>)</li>
                    </ul>
                </li>
                <li>Включите <strong>Автозагрузку</strong> в настройках</li>
            </ol>

            <h4>Методы загрузки</h4>
            <ul>
                <li><strong>Простая загрузка:</strong> файлы менее 4 МБ загружаются одним запросом</li>
                <li><strong>Возобновляемая сессия:</strong> файлы от 4 МБ и больше используют сессии загрузки (можно возобновить при прерывании)</li>
            </ul>

            <h4>Аутентификация и безопасность</h4>
            <ul>
                <li><strong>OAuth 2.0:</strong> аутентификация Microsoft Graph API v1.0</li>
                <li><strong>Хранение токенов:</strong> зашифровано через Android Keystore (с аппаратной поддержкой, если доступно)</li>
                <li><strong>Автообновление:</strong> токены автоматически обновляются за 5 минут до истечения срока</li>
                <li><strong>Отключение:</strong> нажмите "Отключить учетную запись Microsoft", чтобы отозвать доступ и очистить токены</li>
            </ul>

            <hr>

            <h3>Общие настройки загрузки</h3>

            <h4>Удалять после загрузки</h4>
            <p>При включении DashCam автоматически удаляет локальные файлы после успешной загрузки. Это помогает автоматически управлять хранилищем.</p>
            <ul>
                <li><strong>Безопасность:</strong> файлы удаляются только после подтвержденной успешной загрузки</li>
                <li><strong>Телеметрия:</strong> все 4 файла удаляются вместе (mp4, srt, csv, gpx)</li>
                <li><strong>Отслеживание:</strong> статус загрузки сохраняется в DataStore</li>
            </ul>

            <h4>Механизм повтора</h4>
            <p>Неудавшиеся загрузки автоматически повторяются через Android WorkManager:</p>
            <ul>
                <li><strong>Экспоненциальная задержка:</strong> 30 с, 60 с, 120 с, 240 с, 480 с (максимум 8 минут)</li>
                <li><strong>Максимум попыток:</strong> 5 повторов перед отказом</li>
                <li><strong>Ограничения сети:</strong> соблюдает политику лимитных/только Wi-Fi</li>
                <li><strong>Фоновая обработка:</strong> работает даже при закрытом приложении</li>
            </ul>

            <h4>Распространенные сбои загрузки</h4>
            <ul>
                <li><strong>Сеть недоступна:</strong> очередь приостановлена, повторяется при доступности сети</li>
                <li><strong>Несоответствие SSID (SMB):</strong> не в разрешенной сети Wi-Fi</li>
                <li><strong>Сбой аутентификации:</strong> токен OAuth истек или неверные учетные данные</li>
                <li><strong>Назначение недоступно:</strong> SMB-ресурс не в сети или облачный сервис недоступен</li>
                <li><strong>Неверная конфигурация:</strong> отсутствуют необходимые настройки (хост, общий ресурс, учетная запись)</li>
            </ul>

            <div class="alert alert-tip">
                <p><strong>Совет:</strong> Отслеживайте статус загрузки через индикатор в правом верхнем углу главного экрана. Нажмите, чтобы открыть Просмотрщик очереди для подробной информации.</p>
            </div>
        </section>

        <hr>

        <section id="playback">
            <h2>Просмотр записей</h2>

            <h3>Воспроизведение в приложении</h3>
            <p>Нажмите на любую запись на экране Записи для просмотра с синхронизированными наложениями телеметрии.</p>
            <ul>
                <li><strong>Воспроизведение видео:</strong> встроенный плеер со стандартными элементами управления (воспроизведение/пауза, перемотка, громкость)</li>
                <li><strong>SRT-субтитры:</strong> наложения GPS, скорости и временных меток автоматически отображаются (с привязкой к позиции)</li>
                <li><strong>Синхронизация временной шкалы:</strong> данные телеметрии синхронизированы с воспроизведением видео</li>
            </ul>

            <h3>Внешнее воспроизведение</h3>
            <p>Все файлы в стандартных форматах, совместимых с внешним программным обеспечением:</p>
            <ul>
                <li><strong>Видео (.mp4):</strong> воспроизводится в VLC, Windows Media Player, QuickTime и т.д.</li>
                <li><strong>Субтитры (.srt):</strong> загружаются вместе с видео в большинстве медиаплееров
                    <ul>
                        <li>VLC: перетащите файл .srt на видео или поместите в ту же папку с совпадающим именем</li>
                        <li>Показывает GPS-координаты, скорость, дату/время в виде позиционированных наложений</li>
                    </ul>
                </li>
                <li><strong>Данные датчиков (.csv):</strong> открывается в Excel, Google Sheets, Python/R для анализа
                    <ul>
                        <li>Столбцы: временная метка, акселерометр X/Y/Z, гироскоп X/Y/Z, магнитометр X/Y/Z, освещенность, давление, близость</li>
                        <li>Частота 10 Гц (интервалы 100 мс)</li>
                    </ul>
                </li>
                <li><strong>GPS-трек (.gpx):</strong> импортируется в картографическое программное обеспечение
                    <ul>
                        <li>Совместим с: Google Earth, Garmin BaseCamp, GPX Viewer и т.д.</li>
                        <li>Формат GPX 1.1 XML с точками трека и временными метками</li>
                    </ul>
                </li>
            </ul>

            <h3>Доступ к файлам</h3>
            <ul>
                <li><strong>Внутреннее хранилище:</strong> используйте приложение файлового менеджера или подключите телефон через USB (режим MTP)</li>
                <li><strong>Внешнее хранилище:</strong> извлеките SD-карту и вставьте в компьютер, или используйте USB-подключение</li>
                <li><strong>Путь:</strong> <code>/Android/data/com.dashcam.app/files/DashCam/</code> (внутреннее) или ваш настроенный пользовательский путь</li>
            </ul>
        </section>

        <hr>

        <section id="troubleshooting">
            <h2>Устранение неполадок</h2>

            <h3>Распространенные проблемы</h3>
            <table>
                <thead>
                    <tr>
                        <th>Проблема</th>
                        <th>Возможное решение</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Нет предпросмотра видео</td>
                        <td>Предоставьте разрешение камеры в Настройки Android → Приложения → DashCam → Разрешения. Перезапустите приложение.</td>
                    </tr>
                    <tr>
                        <td>GPS не получает сигнал</td>
                        <td>Выйдите на улицу для чистого обзора неба. Убедитесь, что разрешение Местоположение предоставлено и GPS включен в настройках Android. Может потребоваться 30-60 с для первоначальной фиксации.</td>
                    </tr>
                    <tr>
                        <td>Удар не обнаружен (режим AUTO)</td>
                        <td>Настройте чувствительность на ВЫСОКУЮ (1.5G) в настройках. Убедитесь, что телефон надежно закреплен (свободное крепление поглощает удары). Проверьте легким ударом по креплению.</td>
                    </tr>
                    <tr>
                        <td>Запись неожиданно останавливается</td>
                        <td>Проверьте место на диске (автоочистка может удалять файлы). Убедитесь, что предоставлено исключение из оптимизации батареи. Проверьте настройку защиты от дребезга при отключении питания.</td>
                    </tr>
                    <tr>
                        <td>Приложение закрывается при выключенном экране</td>
                        <td>Предоставьте исключение из оптимизации батареи: Настройки → Системные настройки → Открыть настройки батареи → Выберите "Не оптимизировать" для DashCam.</td>
                    </tr>
                    <tr>
                        <td>Ошибки переполнения хранилища</td>
                        <td>Включите автоуправление хранилищем в настройках. Увеличьте порог целевого свободного места. Понизьте качество видео. Включите удаление после загрузки.</td>
                    </tr>
                </tbody>
            </table>

            <h3>Устранение неполадок загрузки</h3>
            <table>
                <thead>
                    <tr>
                        <th>Проблема</th>
                        <th>Возможное решение</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Сбой загрузки SMB</td>
                        <td>Проверьте правильность хоста/общего ресурса/учетных данных. Убедитесь, что оба устройства в одной сети Wi-Fi. Проверьте ограничения SSID. Включите порт 445 в брандмауэре Windows. Убедитесь, что локальная учетная запись Windows имеет разрешения Чтение/Запись.</td>
                    </tr>
                    <tr>
                        <td>Имя хоста не найдено (SMB)</td>
                        <td>Убедитесь, что сетевое обнаружение Windows включено. Проверьте, что NetBIOS работает. Используйте IP-адрес в качестве запасного варианта (найдите через <code>ipconfig</code> в командной строке).</td>
                    </tr>
                    <tr>
                        <td>Сбой аутентификации Google Drive</td>
                        <td>Отключите и подключите учетную запись заново. Проверьте, что учетная запись Google активна. Проверьте интернет-соединение. Очистите данные приложения, если проблема сохраняется.</td>
                    </tr>
                    <tr>
                        <td>Сбой аутентификации OneDrive</td>
                        <td>Отключите и подключите учетную запись заново. Проверьте, что учетная запись Microsoft активна. Проверьте интернет-соединение. Попробуйте другой браузер, если WebView не работает.</td>
                    </tr>
                    <tr>
                        <td>Загрузка застряла в очереди</td>
                        <td>Проверьте подключение к сети. Проверьте настройки только Wi-Fi/лимитных. Проверьте ограничения SSID (SMB). Откройте Просмотрщик очереди и проверьте сообщение об ошибке. Попробуйте ручной повтор.</td>
                    </tr>
                    <tr>
                        <td>Загрузки используют мобильные данные</td>
                        <td>Отключите "Разрешить лимитные подключения" в настройках загрузки. Загрузки будут происходить только через Wi-Fi.</td>
                    </tr>
                </tbody>
            </table>

            <h3>Советы по производительности</h3>
            <ul>
                <li><strong>Оптимизация батареи:</strong> отключите оптимизацию батареи Android для DashCam (Настройки → Системные настройки)</li>
                <li><strong>Качественное зарядное устройство:</strong> используйте зарядное устройство 2A+ для обеспечения стабильного питания во время записи и загрузки</li>
                <li><strong>Управление нагревом:</strong> избегайте прямого воздействия солнечных лучей — перегрев может вызвать тепловое ограничение или отключение</li>
                <li><strong>Производительность хранилища:</strong> используйте высококачественные SD-карты (Class 10, UHS-I или лучше) для внешнего хранилища</li>
                <li><strong>Производительность сети:</strong> для загрузок SMB используйте Wi-Fi 5 ГГц, когда доступно (более высокая скорость передачи)</li>
                <li><strong>Очистка хранилища:</strong> периодически очищайте старые записи вручную или включите удаление после загрузки</li>
            </ul>

            <h3>Расширенная диагностика</h3>
            <p>Если проблемы сохраняются, проверьте Android Logcat для подробных сообщений об ошибках:</p>
            <ol>
                <li>Включите параметры разработчика (Настройки → О телефоне → 7 раз нажмите Номер сборки)</li>
                <li>Включите отладку USB (Настройки → Параметры разработчика)</li>
                <li>Подключите к компьютеру и выполните: <code>adb logcat -s DashCam:*</code></li>
                <li>Ищите сообщения об ошибках с тегами имен компонентов (VideoRecorder, UploadManager и т.д.)</li>
            </ol>
        </section>

        <hr>

        <section id="technical">
            <h2>Технические характеристики</h2>

            <h3>Кодирование видео</h3>
            <ul>
                <li><strong>Кодек:</strong> H.264/AVC (контейнер MP4)</li>
                <li><strong>Частота кадров:</strong> 30 fps (фиксированная)</li>
                <li><strong>Разрешение:</strong> 1280×720, 1920×1080 или 3840×2160 (зависит от устройства)</li>
                <li><strong>Ориентация:</strong> альбомная (поворот на 90° для крепления видеорегистратора)</li>
                <li><strong>Аудио:</strong> кодек AAC, включен в MP4</li>
            </ul>

            <h3>Системы телеметрии</h3>
            <ul>
                <li><strong>Провайдер GPS:</strong> Google Play Services Fused Location (обновления каждую секунду)</li>
                <li><strong>Формат SRT:</strong> субтитры SubRip с позиционированными наложениями (вверху слева, внизу слева, внизу справа)</li>
                <li><strong>Частота CSV:</strong> 10 Гц (интервалы 100 мс) для акселерометра, гироскопа, магнитометра, освещенности, давления, близости</li>
                <li><strong>Формат GPX:</strong> GPS Exchange Format 1.1 XML с точками трека и временными метками</li>
            </ul>

            <h3>Обнаружение удара</h3>
            <ul>
                <li><strong>Алгоритм:</strong> фильтрованная низкими частотами величина акселерометра (alpha=0.8)</li>
                <li><strong>Пороги:</strong> ВЫСОКИЙ=1.5G (15 м/с²), СРЕДНИЙ=2.0G (20 м/с²), НИЗКИЙ=3.0G (30 м/с²)</li>
                <li><strong>Буфер:</strong> 2-минутный кольцевой буфер (1-минутные сегменты), 10-секундный захват после удара</li>
                <li><strong>Частота обновления:</strong> ~20 мс (SENSOR_DELAY_GAME)</li>
            </ul>

            <h3>Архитектура хранилища</h3>
            <ul>
                <li><strong>Внутреннее:</strong> прямой API File в каталог для конкретного приложения</li>
                <li><strong>Внешнее:</strong> Storage Access Framework (SAF) с сохранением DocumentTree</li>
                <li><strong>FileAccessManager:</strong> унифицированный уровень абстракции для API File и DocumentFile</li>
                <li><strong>Вывод видео:</strong> FileOutputOptions (внутреннее), FileDescriptorOutputOptions (внешнее SAF)</li>
            </ul>

            <h3>Архитектура загрузки</h3>
            <ul>
                <li><strong>SMB/CIFS:</strong> библиотека jcifs-ng с разрешением имен NetBIOS</li>
                <li><strong>Google Drive:</strong> API Google Sign-In + Drive REST API v3 (многочастная <5 МБ, возобновляемая ≥5 МБ)</li>
                <li><strong>OneDrive:</strong> Microsoft Graph API v1.0 (простая <4 МБ, возобновляемая сессия ≥4 МБ)</li>
                <li><strong>Повтор:</strong> Android WorkManager с экспоненциальной задержкой (максимум 5 попыток)</li>
                <li><strong>Очередь:</strong> последовательная обработка с отслеживанием прогресса на основе StateFlow</li>
            </ul>

            <h3>Безопасность</h3>
            <ul>
                <li><strong>Токены OAuth:</strong> зашифрованы через EncryptedSharedPreferences + Android Keystore</li>
                <li><strong>Учетные данные SMB:</strong> зашифрованы через Android Keystore (с аппаратной поддержкой, когда доступно)</li>
                <li><strong>Обновление токенов:</strong> автоматическое обновление за 5 минут до истечения срока</li>
                <li><strong>Разрешения:</strong> CAMERA, RECORD_AUDIO, ACCESS_FINE_LOCATION, INTERNET, WAKE_LOCK, FOREGROUND_SERVICE, ACCESS_NETWORK_STATE</li>
            </ul>

            <h3>Фреймворк и библиотеки</h3>
            <ul>
                <li><strong>UI:</strong> Jetpack Compose (декларативный UI)</li>
                <li><strong>Камера:</strong> CameraX (с резервным селектором качества)</li>
                <li><strong>Настройки:</strong> DataStore (Preferences + Proto)</li>
                <li><strong>Параллелизм:</strong> Kotlin Coroutines + Flow</li>
                <li><strong>Воспроизведение медиа:</strong> ExoPlayer</li>
                <li><strong>Фоновая работа:</strong> WorkManager</li>
                <li><strong>SMB:</strong> jcifs-ng</li>
            </ul>

            <h3>Требования к устройству</h3>
            <ul>
                <li><strong>Минимальный Android:</strong> 8.0 Oreo (API 26)</li>
                <li><strong>Целевой Android:</strong> 14 (API 34)</li>
                <li><strong>Камера:</strong> требуется задняя камера (передняя камера не поддерживается)</li>
                <li><strong>Датчики:</strong> требуются GPS, акселерометр; гироскоп, магнитометр, освещенность, давление, близость опциональны</li>
                <li><strong>Хранилище:</strong> минимум 8 ГБ рекомендуется (16+ ГБ для продолжительной записи)</li>
            </ul>
        </section>

        <hr>

        <section id="limitations">
            <h2>Известные ограничения</h2>

            <h3>Текущие ограничения (Beta)</h3>
            <ul>
                <li><strong>Поддержка эмулятора:</strong> видеозапись отключена в эмуляторах Android (ограничение CameraX). Режим только телеметрии работает.</li>
                <li><strong>Совместимость MediaMuxer:</strong> может не работать на некоторых устройствах в режиме AUTO (запасной вариант: сохраняет только последний сегмент)</li>
                <li><strong>Большие файлы PER_TRIP:</strong> очень длинные непрерывные поездки (4+ часа при 1080p) могут превышать 20 ГБ — убедитесь в достаточном хранилище</li>
                <li><strong>Разрешение местоположения Wi-Fi:</strong> Android 10+ требует ACCESS_FINE_LOCATION для доступа к SSID (ограничения Wi-Fi)</li>
            </ul>

            <h3>Соображения по Microsoft OneDrive</h3>
            <ul>
                <li><strong>Истечение секрета клиента:</strong> секрет клиента Microsoft истекает примерно в октябре 2026 года</li>
                <li><strong>Влияние:</strong> приложению потребуется обновление или реализация серверной части до истечения срока</li>
                <li><strong>Смягчение:</strong> пользователи будут уведомлены заблаговременно через обновление приложения</li>
            </ul>

            <h3>Планируемые функции</h3>
            <ul>
                <li><strong>Тепловое управление:</strong> мониторинг температуры и ограничение записи (следующий приоритет)</li>
                <li><strong>Интеграция Dropbox:</strong> в ожидании пользовательского спроса</li>
                <li><strong>Автоматизированное тестирование:</strong> инфраструктура тестирования существует, но тесты еще не реализованы</li>
                <li><strong>Фильтрация типов файлов:</strong> UI для режима загрузки TELEMETRY_ONLY (архитектура завершена)</li>
            </ul>
        </section>

        <hr>

        <section id="safety">
            <h2>Безопасность и ответственность</h2>
            <p>DashCam помогает водителям — это <strong>не</strong> замена безопасному вождению. Всегда соблюдайте местные законы относительно записи в автомобиле.</p>
        </section>

        <hr>

        <section id="support">
            <h2>Поддержка и обратная связь</h2>
            <p>Это <strong>бета-версия</strong> — стабильная для ежедневного использования, с активным продолжением разработки.</p>
            <ul>
                <li>Сообщайте о проблемах или предложениях через страницу GitHub проекта.</li>
                <li>Укажите модель вашего телефона, версию Android и краткое описание проблемы.</li>
            </ul>
            <p><strong>Спасибо за использование DashCam. Безопасных дорог — и ответственной записи.</strong></p>
        </section>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2025 ByteForge. Все права защищены.</p>
            <p>
                <a href="manual.html">Руководство пользователя</a> |
                <a href="eula.html">Условия использования</a> |
                <a href="license.html">Лицензия</a> |
                <a href="privacy-policy.html">Политика конфиденциальности</a>
            </p>
        </div>
    </footer>
</body>
</html>
