<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Aplicación DashCam - Transforma tu teléfono Android en una cámara profesional para el tablero">
    <title>Aplicación DashCam - Manual de Usuario</title>
    <link rel="icon" type="image/png" sizes="192x192" href="../../images/app-icon-192.png">
    <link rel="icon" type="image/png" sizes="96x96" href="../../images/app-icon-96.png">
    <link rel="icon" type="image/png" sizes="48x48" href="../../images/app-icon-48.png">
    <link rel="apple-touch-icon" href="../../images/app-icon-192.png">
    <link rel="stylesheet" href="../../styles.css">
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <img src="../../images/app-icon-96.png" alt="Icono de la aplicación DashCam" class="app-icon">
                <div class="header-text">
                    <h1>Aplicación DashCam — Manual de Usuario</h1>
                    <p class="subtitle">Versión 1.0.0 Beta | Android 8.0+ (API 26+) | Última actualización: 30 de octubre de 2025</p>
                </div>
            </div>
        </div>
    </header>

    <nav>
        <ul>
            <li><a href="manual.html"  class="active">Manual de Usuario</a></li>
            <li><a href="eula.html">Términos de Uso</a></li>
            <li><a href="license.html">Licencia</a></li>
            <li><a href="privacy-policy.html">Política de Privacidad</a></li>
        </ul>
    </nav>

    <div class="container">
        <section id="quick-start">
            <h2>Inicio Rápido</h2>
            <ol>
                <li><strong>Instalar e Iniciar:</strong> Otorga permisos de cámara, micrófono y ubicación cuando se soliciten.</li>
                <li><strong>Montar el Teléfono:</strong> Monta de forma segura en el parabrisas en orientación horizontal, con la cámara trasera hacia adelante.</li>
                <li><strong>Conectar la Energía:</strong> Conecta a una fuente de alimentación que se encienda con el encendido del automóvil (ACC). La aplicación comienza a grabar automáticamente cuando se detecta energía y se detiene cuando se pierde.</li>
                <li><strong>Almacenamiento:</strong> Los videos se guardan internamente de forma predeterminada. Puedes cambiar a tarjeta SD o almacenamiento externo en la configuración.</li>
                <li><strong>Subidas (Opcional):</strong> Configura subidas a tu computadora doméstica, NAS o almacenamiento en la nube (Google Drive, OneDrive) mediante Wi-Fi.</li>
            </ol>
        </section>

        <hr>

        <section id="introduction">
            <h2>Introducción</h2>
            <p>DashCam transforma un teléfono Android antiguo en una cámara de tablero de vehículo confiable y completa. Diseñada para <strong>estabilidad, automatización y simplicidad</strong>, graba automáticamente cuando el automóvil arranca y guarda o sube el video cuando se detiene.</p>

            <h3>Características Principales</h3>
            <ul>
                <li><strong>Grabación automática</strong> vinculada al encendido o detección de impactos</li>
                <li><strong>Detección de impactos</strong> con búfer circular de video (guarda 2 min antes + 10 seg después)</li>
                <li><strong>Telemetría completa:</strong> Registro de GPS, velocidad y sensor de movimiento de 6 ejes</li>
                <li><strong>Subidas flexibles:</strong> Carpeta compartida de Windows (SMB/CIFS) o nube (Google Drive, OneDrive)</li>
                <li><strong>Múltiples formatos de salida:</strong> Video MP4, subtítulos SRT, datos de sensores CSV, pistas GPX</li>
                <li><strong>Gestión automática de almacenamiento:</strong> Eliminación automática configurable cuando el espacio es escaso</li>
                <li><strong>Subidas basadas en cola:</strong> Reintento automático con procesamiento en segundo plano</li>
                <li><strong>Credenciales seguras:</strong> Almacenamiento cifrado mediante Android Keystore</li>
                <li><strong>Soporte NetBIOS:</strong> Usa nombres de host de Windows en lugar de direcciones IP</li>
                <li><strong>Optimizado para batería:</strong> Diseñado para operación continua con consumo mínimo de energía</li>
                <li><strong>Operación sin intervención:</strong> Instala una vez, conduce a diario — no se necesita interacción</li>
            </ul>
        </section>

        <hr>

        <section id="getting-started">
            <h2>Empezando</h2>

            <h3>Permisos</h3>
            <p>Otorga estos permisos en el primer inicio:</p>
            <ul>
                <li><strong>Cámara</strong> – Requerida para la grabación de video.</li>
                <li><strong>Micrófono</strong> – Para captura de audio en las grabaciones.</li>
                <li><strong>Ubicación</strong> – Para coordenadas GPS, registro de velocidad y detección de SSID de WiFi (restricciones de subida).</li>
                <li><strong>Almacenamiento</strong> – (Android 9 y anteriores) Para guardar grabaciones en el dispositivo.</li>
            </ul>

            <h3>Optimización de Batería</h3>
            <p>DashCam solicitará <strong>exención de optimización de batería</strong> en el primer inicio. Esto asegura que la aplicación pueda:</p>
            <ul>
                <li>Continuar grabando cuando la pantalla esté apagada</li>
                <li>Completar subidas después de que se desconecte la energía</li>
                <li>Monitorear impactos en modo AUTO</li>
            </ul>
            <p>Puedes verificar el estado de optimización de batería en <strong>Configuración → Configuración del Sistema</strong>.</p>

            <h3>Montaje del Teléfono</h3>
            <ul>
                <li>Usa un <strong>soporte de parabrisas o tablero</strong> con una vista frontal estable.</li>
                <li>Mantén los cables ordenados y fuera de tu línea de visión.</li>
                <li>Conecta la energía desde un cargador conectado al encendido (ACC) para operación automática.</li>
            </ul>

            <h3>Comportamiento de Energía</h3>
            <ul>
                <li><strong>Encendido Activado (Energía Conectada):</strong> La grabación comienza automáticamente.</li>
                <li><strong>Encendido Desactivado (Energía Perdida):</strong> La grabación se detiene de forma segura y comienzan las subidas (si están configuradas). El teléfono permanece activo para finalizar las subidas, luego se suspende para conservar energía.</li>
            </ul>
        </section>

        <hr>

        <section id="main-screen">
            <h2>Pantalla Principal</h2>

            <h3>Diseño de Pantalla</h3>
            <ul>
                <li><strong>Superior-Izquierda:</strong> Fecha y hora actual (formato configurable en la configuración)</li>
                <li><strong>Superior-Derecha:</strong> Botón de configuración + Indicador de estado de subida</li>
                <li><strong>Inferior-Izquierda:</strong> Coordenadas GPS, dirección de la brújula y estado de grabación</li>
                <li><strong>Inferior-Derecha:</strong> Velocidad actual (mph o km/h, configurable)</li>
                <li><strong>Centro:</strong> Vista previa de cámara en vivo</li>
                <li><strong>Centro-Derecha:</strong> Botón de grabación manual (FAB)</li>
            </ul>

            <h3>Indicadores de Estado</h3>
            <ul>
                <li><strong>REC (Cuadro Rojo):</strong> Grabando video actualmente</li>
                <li><strong>AUTO (Cuadro Verde):</strong> El búfer del modo AUTO está ejecutándose (esperando impacto)</li>
                <li><strong>Botón de Grabación Manual:</strong>
                    <ul>
                        <li>Círculo rojo (⏺) = No está grabando, toca para iniciar</li>
                        <li>Cuadrado blanco (⏹) = Grabando, toca para detener</li>
                    </ul>
                </li>
            </ul>

            <h3>Indicadores de Subida (Superior-Derecha)</h3>
            <ul>
                <li><strong>Icono de subida verde (⏫):</strong> Subidas activas en progreso (muestra recuento)</li>
                <li><strong>Icono de pausa naranja (⏸):</strong> Subidas pausadas (muestra recuento, toca para abrir el Visor de Cola)</li>
                <li><strong>Icono de advertencia rojo (⚠️):</strong> Errores de subida (muestra recuento, toca para ver errores)</li>
            </ul>

            <div class="alert alert-warning">
                <p><strong>Nota:</strong> Si ves "EMULADOR – Grabación de video deshabilitada," estás ejecutando en un emulador de Android. La grabación de video requiere un dispositivo físico con cámara.</p>
            </div>
        </section>

        <hr>

        <section id="recording-modes">
            <h2>Modos de Grabación</h2>

            <h3>1. AUTO (Detección de Impactos)</h3>
            <p>Perfecto para la conducción diaria — ahorra almacenamiento al guardar solo momentos importantes.</p>
            <ul>
                <li>Graba segmentos continuos de 1 minuto en un búfer circular</li>
                <li>Mantiene solo los últimos 2 minutos en memoria (30+ segundos garantizados antes del impacto)</li>
                <li>Cuando el acelerómetro detecta un impacto, DashCam:
                    <ul>
                        <li>Preserva el búfer de 2 minutos (antes del impacto)</li>
                        <li>Graba 10 segundos adicionales (después del impacto)</li>
                        <li>Guarda la grabación completa con todos los datos de telemetría</li>
                    </ul>
                </li>
                <li><strong>Sensibilidad de Impacto:</strong> ALTA (1.5G), MEDIA (2.0G, predeterminada), BAJA (3.0G)</li>
                <li><strong>Nombre de archivo:</strong> <code>DashCam-20250115-143022-Impact.mp4</code></li>
                <li><strong>Comportamiento de energía:</strong> Ignora eventos de energía (solo responde a impactos)</li>
            </ul>

            <h3>2. PER_TRIP</h3>
            <p>Una grabación continua por ciclo de energía — ideal para documentación completa del viaje.</p>
            <ul>
                <li>Comienza automáticamente cuando se conecta la energía (encendido activado)</li>
                <li>Se detiene cuando se desconecta la energía (encendido desactivado)</li>
                <li>Retardo de rebote configurable (0-60 segundos, predeterminado 10s) previene detenciones durante fluctuaciones breves de energía</li>
                <li>Numeración automática de viajes: escanea archivos existentes para evitar duplicados</li>
                <li><strong>Nombre de archivo:</strong> <code>DashCam-20250115-Trip01.mp4</code></li>
            </ul>

            <h3>3. Bucle Temporizado (5/10/30 minutos)</h3>
            <p>Divide las grabaciones en segmentos de duración fija para facilitar la gestión y subida.</p>
            <ul>
                <li>Crea nuevo segmento cada 5, 10 o 30 minutos</li>
                <li>Se alinea con límites de reloj (ej., modo 10 min: :00, :10, :20, :30, :40, :50)</li>
                <li>Reinicia automáticamente el siguiente segmento hasta que se desconecte la energía</li>
                <li>Ideal para equilibrar el tamaño del archivo con la comodidad de subida</li>
                <li><strong>Nombre de archivo:</strong> <code>DashCam-20250115-1430.mp4</code> (redondeado al límite del segmento)</li>
            </ul>

            <h3>4. Manual</h3>
            <p>Control completo — graba cuando quieras.</p>
            <ul>
                <li>Toca el botón de círculo rojo para comenzar a grabar</li>
                <li>Toca el botón de cuadrado blanco para detener la grabación</li>
                <li>Disponible independientemente del estado de energía u otras configuraciones</li>
                <li>Independiente de los modos de grabación automática</li>
            </ul>

            <div class="alert alert-tip">
                <p><strong>Consejo:</strong> Puedes usar la grabación Manual en cualquier momento, incluso mientras el modo AUTO se ejecuta en segundo plano.</p>
            </div>
        </section>

        <hr>

        <section id="settings">
            <h2>Vista General de Configuración</h2>

            <h3>Configuración de Pantalla</h3>
            <ul>
                <li><strong>Unidades de Velocidad:</strong> mph o km/h</li>
                <li><strong>Formato de Fecha:</strong> MM/DD/AAAA, DD/MM/AAAA o AAAA-MM-DD</li>
                <li><strong>Formato de Hora:</strong> 12 horas o 24 horas</li>
                <li><strong>Mantener Pantalla Encendida:</strong> Evita el tiempo de espera de la pantalla mientras se graba</li>
            </ul>

            <h3>Configuración de Video</h3>
            <ul>
                <li><strong>Calidad de Video:</strong>
                    <ul>
                        <li>720p (50 MB/min) — Viajes largos, almacenamiento limitado</li>
                        <li>1080p (80 MB/min, predeterminado) — Calidad equilibrada</li>
                        <li>2160p/4K (200 MB/min) — Máximo detalle, requiere almacenamiento grande</li>
                    </ul>
                </li>
            </ul>

            <h3>Configuración de Grabación</h3>
            <ul>
                <li><strong>Modo de Grabación:</strong> AUTO, PER_TRIP, 5MIN, 10MIN, 30MIN</li>
                <li><strong>Sensibilidad de Impacto:</strong> ALTA (1.5G), MEDIA (2.0G, predeterminada), BAJA (3.0G)
                    <br><em>Solo visible en modo AUTO</em>
                </li>
                <li><strong>Ubicación de Almacenamiento:</strong> INTERNA o EXTERNA (tarjeta SD/USB)</li>
                <li><strong>Seleccionar Carpeta Personalizada:</strong> Elige la ruta de almacenamiento externo (selector de carpetas SAF)</li>
            </ul>

            <h3>Configuración de Subidas</h3>
            <ul>
                <li><strong>Habilitar Subida Automática:</strong> Activa subidas automáticas después de la grabación</li>
                <li><strong>Permitir Conexiones de Pago:</strong> Habilita subidas mediante datos celulares (predeterminado: solo WiFi)</li>
                <li><strong>Eliminar Después de Subir:</strong> Elimina automáticamente los archivos locales después de una subida exitosa</li>
                <li><strong>Visor de Cola de Subidas:</strong> Monitorea y gestiona la cola de subidas</li>
                <li><strong>Destino de Subida:</strong> SMB, Google Drive o OneDrive</li>
                <li><strong>Configuración de Destino:</strong> Ver secciones detalladas a continuación para cada tipo</li>
            </ul>

            <h3>Gestión de Almacenamiento</h3>
            <ul>
                <li><strong>Gestionar Almacenamiento Automáticamente:</strong> Elimina automáticamente las grabaciones más antiguas cuando el almacenamiento es escaso (predeterminado: habilitado)</li>
                <li><strong>Espacio Libre Objetivo:</strong> Umbral configurable 1-20 GB (predeterminado: 5 GB)
                    <ul>
                        <li>Nivel de ADVERTENCIA: Menos de 3 GB libres</li>
                        <li>Nivel CRÍTICO: Menos de 2 GB libres</li>
                    </ul>
                </li>
                <li><strong>Estado en Tiempo Real:</strong> Visualización del espacio libre actual con advertencias codificadas por colores</li>
            </ul>

            <h3>Gestión de Energía</h3>
            <ul>
                <li><strong>Rebote de Desconexión de Energía:</strong> Retardo antes de detener en pérdida de energía (0-60 segundos, predeterminado 10s)
                    <br><em>Previene detenciones de grabación durante fluctuaciones breves de energía</em>
                </li>
            </ul>

            <h3>Configuración del Sistema</h3>
            <ul>
                <li><strong>Estado de Optimización de Batería:</strong> Muestra si la aplicación está exenta de optimización de batería</li>
                <li><strong>Abrir Configuración de Batería:</strong> Enlace directo a la configuración de optimización de batería de Android</li>
            </ul>

            <h3>Legal y Documentación</h3>
            <ul>
                <li>Manual de Usuario (este documento)</li>
                <li>Acuerdo de Licencia de Usuario Final (EULA)</li>
                <li>Licencia de Software</li>
                <li>Política de Privacidad</li>
            </ul>
        </section>

        <hr>

        <section id="storage">
            <h2>Gestión de Almacenamiento</h2>

            <h3>Ubicación Predeterminada</h3>
            <code>/Android/data/com.dashcam.app/files/DashCam/</code>
            <p>Este es almacenamiento específico de la aplicación, accesible sin permisos especiales en Android 10+.</p>

            <h3>Almacenamiento en Tarjeta SD o Externa</h3>
            <ol>
                <li>Ve a <strong>Configuración → Configuración de Grabación → Ubicación de Almacenamiento</strong>.</li>
                <li>Elige <strong>EXTERNA</strong>.</li>
                <li>Toca <strong>Seleccionar Carpeta Personalizada</strong> y elige tu ruta de tarjeta SD o almacenamiento USB.</li>
                <li>Otorga permiso cuando se solicite (Framework de Acceso a Almacenamiento).</li>
            </ol>
            <div class="alert alert-tip">
                <p><strong>Consejo:</strong> El almacenamiento externo es ideal para tarjetas SD de gran capacidad o unidades USB. Asegúrate de que el dispositivo de almacenamiento permanezca conectado mientras se graba.</p>
            </div>

            <h3>Formatos de Archivo y Salida</h3>
            <p>Cada grabación crea <strong>cuatro archivos sincronizados</strong>:</p>
            <ul>
                <li><strong>.mp4</strong> — Video H.264 con audio (30 fps)</li>
                <li><strong>.srt</strong> — Subtítulos SubRip con GPS, velocidad, fecha/hora (intervalos de 1 segundo)</li>
                <li><strong>.csv</strong> — Datos de sensores: acelerómetro, giroscopio, magnetómetro, luz, presión, proximidad (muestreo de 10 Hz)</li>
                <li><strong>.gpx</strong> — Pista GPS en formato XML GPX 1.1 (compatible con software de mapeo)</li>
            </ul>

            <h3>Tamaños de Archivo (Aproximados)</h3>
            <table>
                <thead>
                    <tr>
                        <th>Calidad</th>
                        <th>MB/min</th>
                        <th>Grabación de 1 Hora</th>
                        <th>Uso Recomendado</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>720p</td>
                        <td>50</td>
                        <td>~3 GB</td>
                        <td>Viajes largos, almacenamiento limitado</td>
                    </tr>
                    <tr>
                        <td>1080p</td>
                        <td>80</td>
                        <td>~4.8 GB</td>
                        <td>Calidad equilibrada (predeterminado)</td>
                    </tr>
                    <tr>
                        <td>2160p/4K</td>
                        <td>200</td>
                        <td>~12 GB</td>
                        <td>Máximo detalle, almacenamiento grande</td>
                    </tr>
                    <tr>
                        <td>Telemetría</td>
                        <td>&lt;0.2</td>
                        <td>&lt;12 MB</td>
                        <td>Todos los modos (insignificante)</td>
                    </tr>
                </tbody>
            </table>

            <h3>Gestión Automática de Almacenamiento</h3>
            <p>Cuando <strong>Gestionar Almacenamiento Automáticamente</strong> está habilitado (predeterminado), DashCam elimina automáticamente las grabaciones más antiguas cuando el espacio libre cae por debajo del umbral configurado.</p>
            <ul>
                <li><strong>Umbral predeterminado:</strong> 5 GB de espacio libre</li>
                <li><strong>Rango configurable:</strong> 1-20 GB</li>
                <li><strong>Comportamiento de eliminación:</strong> Elimina conjuntos completos de grabaciones (los 4 archivos juntos), los más antiguos primero</li>
                <li><strong>Niveles de advertencia:</strong> Alertas visuales cuando está por debajo de 3 GB (ADVERTENCIA) o 2 GB (CRÍTICO)</li>
            </ul>
            <div class="alert alert-warning">
                <p><strong>Importante:</strong> Si deshabilitas la gestión automática, monitorea el almacenamiento manualmente para prevenir fallos de grabación.</p>
            </div>
        </section>

        <hr>

        <section id="uploads">
            <h2>Configuración de Subida</h2>
            <p>DashCam admite subidas automáticas a <strong>carpeta compartida de Windows <small>(SMB/CIFS)</small></strong>, <strong>Google Drive</strong> y <strong>OneDrive</strong>. El sistema de subida basado en cola incluye reintento automático, procesamiento en segundo plano y monitoreo en tiempo real.</p>

            <h3>Activadores de Subida</h3>
            <p>Las subidas se pueden activar de tres formas:</p>
            <ol>
                <li><strong>Automático (Después de Grabar):</strong> Cuando la subida automática está habilitada, las grabaciones se suben inmediatamente después de completarse</li>
                <li><strong>Encolar Todo Manualmente:</strong> Cambia de modo MANUAL a modo de subida automática para encolar todas las grabaciones existentes</li>
                <li><strong>Reintento en Segundo Plano:</strong> Las subidas fallidas se reintentan automáticamente con retroceso exponencial (30s, 60s, 120s, 240s, 480s)</li>
            </ol>

            <h3>Requisitos de Red</h3>
            <ul>
                <li><strong>WiFi Recomendado:</strong> Por defecto, las subidas solo ocurren en redes WiFi</li>
                <li><strong>Permitir de Pago:</strong> Habilita esta configuración para permitir subidas mediante datos celulares (puede incurrir en cargos de datos)</li>
                <li><strong>Conexión Activa:</strong> El dispositivo debe tener conectividad a internet durante la subida</li>
            </ul>

            <h3>Visor de Cola de Subidas</h3>
            <p>Accede al Visor de Cola desde <strong>Configuración → Configuración de Subidas → Visor de Cola de Subidas</strong> para:</p>
            <ul>
                <li><strong>Monitorear Progreso:</strong> Estado de subida en tiempo real con barras de progreso</li>
                <li><strong>Pausar/Reanudar:</strong> Controla el procesamiento de subidas (el estado persiste entre reinicios de la aplicación)</li>
                <li><strong>Reintentar Errores:</strong> Reintenta manualmente subidas fallidas</li>
                <li><strong>Ver Historial:</strong> Ver grabaciones subidas previamente</li>
                <li><strong>Resubir:</strong> Resube archivos previamente exitosos si es necesario</li>
                <li><strong>Limpiar Cola:</strong> Elimina todos los elementos en cola y reescanea el almacenamiento</li>
            </ul>

            <h3>Estados de la Cola</h3>
            <ul>
                <li><strong>INACTIVO:</strong> En cola, esperando subir</li>
                <li><strong>SUBIENDO:</strong> Transfiriendo actualmente</li>
                <li><strong>ERROR:</strong> Falló (detiene la cola, se requiere reintento manual)</li>
                <li><strong>HECHO:</strong> Subido exitosamente (mantenido en historial)</li>
            </ul>

            <hr>

            <h3>Configuración de Carpeta Compartida de Windows <small>(SMB/CIFS)</small></h3>
            <p>Sube grabaciones a tu computadora doméstica, NAS o servidor Windows.</p>

            <h4>Pasos de Configuración</h4>
            <ol>
                <li>En Configuración, establece <strong>Tipo de Destino de Subida</strong> a <strong>Carpeta de Red</strong></li>
                <li>Configura los detalles de conexión:
                    <ul>
                        <li><strong>Host:</strong> Nombre de host de Windows (ej., <code>MIPC</code>) o dirección IP (ej., <code>192.168.1.100</code>)</li>
                        <li><strong>Nombre de Recurso:</strong> Nombre del recurso SMB (ej., <code>dashcam</code>)</li>
                        <li><strong>Ruta:</strong> Subcarpeta opcional dentro del recurso (ej., <code>grabaciones/2025</code>)</li>
                        <li><strong>Nombre de Usuario:</strong> Nombre de usuario de cuenta local de Windows (opcional para acceso de invitado)</li>
                        <li><strong>Contraseña:</strong> Contraseña de cuenta (cifrada mediante Android Keystore)</li>
                    </ul>
                </li>
                <li><strong>Restricciones de Red WiFi:</strong> Opcionalmente restringe subidas a SSID de WiFi específicos (separados por comas)</li>
                <li>Habilita <strong>Subida Automática</strong> en Configuración</li>
            </ol>

            <h4>Resolución de Nombre de Host NetBIOS</h4>
            <p>DashCam admite <strong>resolución de nombres NetBIOS</strong>, permitiéndote usar nombres de computadoras Windows en lugar de direcciones IP.</p>
            <ul>
                <li><strong>Requisitos:</strong> Ambos dispositivos en la misma red WiFi, Descubrimiento de Red de Windows habilitado</li>
                <li><strong>Ejemplo:</strong> Usa <code>DESKTOP-ABC123</code> en lugar de <code>192.168.1.100</code></li>
                <li><strong>Respaldo:</strong> Si el nombre de host falla, usa la dirección IP (encuentra mediante <code>ipconfig</code> en el Símbolo del sistema)</li>
            </ul>
            <blockquote><em>Nota: NetBIOS funciona principalmente con redes Windows. Los usuarios de macOS/Linux deben usar direcciones IP.</em></blockquote>

            <h4>Creación de una Cuenta Local de Windows</h4>
            <p>Windows 10+ requiere acceso autenticado (sin recursos compartidos de invitado):</p>
            <ol>
                <li>Presiona <strong>Win + I</strong> → <strong>Cuentas</strong> → <strong>Familia y otros usuarios</strong></li>
                <li>Haz clic en <strong>Agregar otra persona a esta PC</strong></li>
                <li>Selecciona <strong>No tengo la información de inicio de sesión de esta persona</strong></li>
                <li>Selecciona <strong>Agregar un usuario sin cuenta de Microsoft</strong></li>
                <li>Crea nombre de usuario (ej., <code>dashcam</code>) y contraseña</li>
                <li>Haz clic derecho en la carpeta compartida → <strong>Propiedades</strong> → pestaña <strong>Compartir</strong> → <strong>Compartir</strong></li>
                <li>Agrega el nuevo usuario con permisos de <strong>Lectura/Escritura</strong></li>
                <li>También verifica la pestaña <strong>Seguridad</strong> y otorga permisos de Lectura/Escritura allí</li>
            </ol>

            <h4>Restricciones de SSID WiFi (Solo SMB)</h4>
            <p>Previene subidas mediante WiFi público restringiendo a redes específicas:</p>
            <ul>
                <li><strong>Configuración:</strong> Subir Solo en Redes (SSID separados por comas)</li>
                <li><strong>Ejemplo:</strong> <code>WiFiCasa,Oficina5G</code></li>
                <li><strong>Comportamiento:</strong> Si se configuran SSID, las subidas solo ocurren cuando se conecta a redes listadas</li>
                <li><strong>Agregar automáticamente:</strong> La aplicación agrega automáticamente el SSID actual al configurar SMB por primera vez</li>
                <li><strong>Vacío = Cualquier Red:</strong> Deja vacío para permitir subidas en cualquier WiFi</li>
            </ul>
            <div class="alert alert-warning">
                <p><strong>Nota:</strong> Las restricciones de SSID se aplican <strong>solo a destinos SMB</strong>. Las subidas de Google Drive y OneDrive funcionan en cualquier red (servicios basados en internet).</p>
            </div>

            <hr>

            <h3>Configuración de Google Drive</h3>
            <p>Sube grabaciones directamente a tu cuenta de Google Drive.</p>

            <h4>Pasos de Configuración</h4>
            <ol>
                <li>En Configuración, establece <strong>Tipo de Destino de Subida</strong> a <strong>Google Drive</strong></li>
                <li>Toca <strong>Conectar Cuenta de Google</strong></li>
                <li>Selecciona tu cuenta de Google del selector de cuentas nativo</li>
                <li>Autoriza DashCam para acceder a Google Drive (permiso Files.ReadWrite)</li>
                <li>Configura la estructura de carpetas:
                    <ul>
                        <li><strong>Carpeta Raíz:</strong> Nombre de carpeta principal (ej., <code>DashCam</code>) - creada automáticamente si no existe</li>
                        <li><strong>Subcarpeta:</strong> Ruta de subcarpeta opcional (ej., <code>2025/Enero</code>)</li>
                    </ul>
                </li>
                <li>Habilita <strong>Subida Automática</strong> en Configuración</li>
            </ol>

            <h4>Métodos de Subida</h4>
            <ul>
                <li><strong>Subida Multiparte:</strong> Archivos menores de 5 MB se suben en una solicitud</li>
                <li><strong>Subida Reanudable:</strong> Archivos de 5 MB y mayores se suben en fragmentos de 5 MB (se puede reanudar si se interrumpe)</li>
            </ul>

            <h4>Autenticación y Seguridad</h4>
            <ul>
                <li><strong>OAuth 2.0:</strong> Autenticación segura estándar de la industria</li>
                <li><strong>Almacenamiento de Tokens:</strong> Cifrado mediante Android Keystore (respaldado por hardware si está disponible)</li>
                <li><strong>Actualización Automática:</strong> Los tokens se actualizan automáticamente 5 minutos antes de expirar</li>
                <li><strong>Desconectar:</strong> Toca "Desconectar Cuenta de Google" para revocar el acceso y borrar tokens</li>
            </ul>

            <hr>

            <h3>Configuración de OneDrive</h3>
            <p>Sube grabaciones a tu cuenta de Microsoft OneDrive.</p>

            <h4>Pasos de Configuración</h4>
            <ol>
                <li>En Configuración, establece <strong>Tipo de Destino de Subida</strong> a <strong>OneDrive</strong></li>
                <li>Toca <strong>Conectar Cuenta de Microsoft</strong></li>
                <li>Inicia sesión mediante el flujo web OAuth 2.0 de Microsoft (se abre en WebView)</li>
                <li>Autoriza DashCam para acceder a OneDrive (permiso Files.ReadWrite)</li>
                <li>Configura la estructura de carpetas:
                    <ul>
                        <li><strong>Carpeta Raíz:</strong> Nombre de carpeta principal (ej., <code>DashCam</code>) - creada automáticamente si no existe</li>
                        <li><strong>Subcarpeta:</strong> Ruta de subcarpeta opcional (ej., <code>2025/Enero</code>)</li>
                    </ul>
                </li>
                <li>Habilita <strong>Subida Automática</strong> en Configuración</li>
            </ol>

            <h4>Métodos de Subida</h4>
            <ul>
                <li><strong>Subida Simple:</strong> Archivos menores de 4 MB se suben en una solicitud</li>
                <li><strong>Sesión Reanudable:</strong> Archivos de 4 MB y mayores usan sesiones de subida (se puede reanudar si se interrumpe)</li>
            </ul>

            <h4>Autenticación y Seguridad</h4>
            <ul>
                <li><strong>OAuth 2.0:</strong> Autenticación de Microsoft Graph API v1.0</li>
                <li><strong>Almacenamiento de Tokens:</strong> Cifrado mediante Android Keystore (respaldado por hardware si está disponible)</li>
                <li><strong>Actualización Automática:</strong> Los tokens se actualizan automáticamente 5 minutos antes de expirar</li>
                <li><strong>Desconectar:</strong> Toca "Desconectar Cuenta de Microsoft" para revocar el acceso y borrar tokens</li>
            </ul>

            <hr>

            <h3>Configuración General de Subidas</h3>

            <h4>Eliminar Después de Subir</h4>
            <p>Cuando está habilitado, DashCam elimina automáticamente los archivos locales después de una subida exitosa. Esto ayuda a gestionar el almacenamiento automáticamente.</p>
            <ul>
                <li><strong>Seguridad:</strong> Los archivos solo se eliminan después de una subida exitosa confirmada</li>
                <li><strong>Telemetría:</strong> Los 4 archivos se eliminan juntos (mp4, srt, csv, gpx)</li>
                <li><strong>Seguimiento:</strong> El estado de subida persiste en DataStore</li>
            </ul>

            <h4>Mecanismo de Reintento</h4>
            <p>Las subidas fallidas se reintentan automáticamente mediante Android WorkManager:</p>
            <ul>
                <li><strong>Retroceso Exponencial:</strong> 30s, 60s, 120s, 240s, 480s (8 minutos máximo)</li>
                <li><strong>Intentos Máximos:</strong> 5 reintentos antes de rendirse</li>
                <li><strong>Restricciones de Red:</strong> Respeta la política de pago/solo-WiFi</li>
                <li><strong>Procesamiento en Segundo Plano:</strong> Funciona incluso cuando la aplicación está cerrada</li>
            </ul>

            <h4>Fallos Comunes de Subida</h4>
            <ul>
                <li><strong>Red No Disponible:</strong> Cola pausada, reintenta cuando la red esté disponible</li>
                <li><strong>SSID No Coincide (SMB):</strong> No está en la red WiFi permitida</li>
                <li><strong>Autenticación Falló:</strong> Token OAuth expirado o credenciales inválidas</li>
                <li><strong>Destino No Disponible:</strong> Recurso SMB fuera de línea o servicio en la nube caído</li>
                <li><strong>Configuración Inválida:</strong> Faltan configuraciones requeridas (host, recurso, cuenta)</li>
            </ul>

            <div class="alert alert-tip">
                <p><strong>Consejo:</strong> Monitorea el estado de subida mediante el indicador superior derecho en la pantalla principal. Toca para abrir el Visor de Cola para información detallada.</p>
            </div>
        </section>

        <hr>

        <section id="playback">
            <h2>Visualización de Grabaciones</h2>

            <h3>Reproducción en la Aplicación</h3>
            <p>Toca cualquier grabación de la pantalla de Grabaciones para ver con superposiciones de telemetría sincronizadas.</p>
            <ul>
                <li><strong>Reproducción de Video:</strong> Reproductor integrado con controles estándar (reproducir/pausar, buscar, volumen)</li>
                <li><strong>Subtítulos SRT:</strong> Superposiciones de GPS, velocidad y marca de tiempo mostradas automáticamente (coincidentes con la posición)</li>
                <li><strong>Sincronización de Línea de Tiempo:</strong> Datos de telemetría sincronizados con la reproducción de video</li>
            </ul>

            <h3>Reproducción Externa</h3>
            <p>Todos los archivos son formatos estándar compatibles con software externo:</p>
            <ul>
                <li><strong>Video (.mp4):</strong> Reproduce en VLC, Windows Media Player, QuickTime, etc.</li>
                <li><strong>Subtítulos (.srt):</strong> Carga junto al video en la mayoría de los reproductores multimedia
                    <ul>
                        <li>VLC: Arrastra el archivo .srt sobre el video o colócalo en la misma carpeta con el mismo nombre</li>
                        <li>Muestra coordenadas GPS, velocidad, fecha/hora como superposiciones posicionadas</li>
                    </ul>
                </li>
                <li><strong>Datos de Sensores (.csv):</strong> Abre en Excel, Google Sheets, Python/R para análisis
                    <ul>
                        <li>Columnas: Marca de tiempo, Acelerómetro X/Y/Z, Giroscopio X/Y/Z, Magnetómetro X/Y/Z, Luz, Presión, Proximidad</li>
                        <li>Muestreo de 10 Hz (intervalos de 100ms)</li>
                    </ul>
                </li>
                <li><strong>Pista GPS (.gpx):</strong> Importa en software de mapeo
                    <ul>
                        <li>Compatible con: Google Earth, Garmin BaseCamp, GPX Viewer, etc.</li>
                        <li>Formato XML GPX 1.1 con puntos de pista y marcas de tiempo</li>
                    </ul>
                </li>
            </ul>

            <h3>Acceso a Archivos</h3>
            <ul>
                <li><strong>Almacenamiento Interno:</strong> Usa una aplicación de administrador de archivos o conecta el teléfono mediante USB (modo MTP)</li>
                <li><strong>Almacenamiento Externo:</strong> Retira la tarjeta SD e insértala en la computadora, o usa conexión USB</li>
                <li><strong>Ruta:</strong> <code>/Android/data/com.dashcam.app/files/DashCam/</code> (interno) o tu ruta personalizada configurada</li>
            </ul>
        </section>

        <hr>

        <section id="troubleshooting">
            <h2>Solución de Problemas</h2>

            <h3>Problemas Comunes</h3>
            <table>
                <thead>
                    <tr>
                        <th>Problema</th>
                        <th>Posible Solución</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>No hay vista previa de video</td>
                        <td>Otorga permiso de cámara en Configuración de Android → Aplicaciones → DashCam → Permisos. Reinicia la aplicación.</td>
                    </tr>
                    <tr>
                        <td>GPS no adquiere señal</td>
                        <td>Muévete al exterior para una vista clara del cielo. Asegúrate de que el permiso de Ubicación esté otorgado y GPS habilitado en la configuración de Android. Puede tardar 30-60s para la fijación inicial.</td>
                    </tr>
                    <tr>
                        <td>Impacto no detectado (modo AUTO)</td>
                        <td>Ajusta la sensibilidad a ALTA (1.5G) en la configuración. Asegúrate de que el teléfono esté montado de forma segura (un montaje suelto absorbe impactos). Prueba con un toque suave en el montaje.</td>
                    </tr>
                    <tr>
                        <td>La grabación se detiene inesperadamente</td>
                        <td>Verifica el espacio de almacenamiento (la eliminación automática puede estar eliminando archivos). Verifica que se haya otorgado la exención de optimización de batería. Verifica la configuración de rebote de desconexión de energía.</td>
                    </tr>
                    <tr>
                        <td>La aplicación se cierra cuando la pantalla está apagada</td>
                        <td>Otorga exención de optimización de batería: Configuración → Configuración del Sistema → Abrir Configuración de Batería → Selecciona "No optimizar" para DashCam.</td>
                    </tr>
                    <tr>
                        <td>Errores de almacenamiento lleno</td>
                        <td>Habilita gestión automática de almacenamiento en la configuración. Aumenta el umbral de espacio libre objetivo. Reduce la calidad de video. Habilita eliminar después de subir.</td>
                    </tr>
                </tbody>
            </table>

            <h3>Solución de Problemas de Subida</h3>
            <table>
                <thead>
                    <tr>
                        <th>Problema</th>
                        <th>Posible Solución</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>La subida SMB falla</td>
                        <td>Verifica que host/recurso/credenciales sean correctos. Asegúrate de que ambos dispositivos estén en el mismo WiFi. Verifica las restricciones de SSID. Habilita el puerto 445 en el Firewall de Windows. Verifica que la cuenta local de Windows tenga permisos de Lectura/Escritura.</td>
                    </tr>
                    <tr>
                        <td>Nombre de host no encontrado (SMB)</td>
                        <td>Verifica que el Descubrimiento de Red de Windows esté habilitado. Verifica que NetBIOS esté ejecutándose. Usa la dirección IP como respaldo (encuentra mediante <code>ipconfig</code> en el Símbolo del sistema).</td>
                    </tr>
                    <tr>
                        <td>La autenticación de Google Drive falla</td>
                        <td>Desconecta y reconecta la cuenta. Verifica que la cuenta de Google esté activa. Verifica la conexión a internet. Borra los datos de la aplicación si persiste.</td>
                    </tr>
                    <tr>
                        <td>La autenticación de OneDrive falla</td>
                        <td>Desconecta y reconecta la cuenta. Verifica que la cuenta de Microsoft esté activa. Verifica la conexión a internet. Prueba con un navegador diferente si WebView falla.</td>
                    </tr>
                    <tr>
                        <td>Subida atascada en la cola</td>
                        <td>Verifica la conectividad de red. Verifica la configuración de solo-WiFi/de pago. Verifica las restricciones de SSID (SMB). Abre el Visor de Cola y verifica el mensaje de error. Prueba el reintento manual.</td>
                    </tr>
                    <tr>
                        <td>Las subidas usan datos celulares</td>
                        <td>Deshabilita "Permitir Conexiones de Pago" en la Configuración de Subidas. Las subidas solo ocurrirán en WiFi.</td>
                    </tr>
                </tbody>
            </table>

            <h3>Consejos de Rendimiento</h3>
            <ul>
                <li><strong>Optimización de Batería:</strong> Deshabilita la optimización de batería de Android para DashCam (Configuración → Configuración del Sistema)</li>
                <li><strong>Cargador de Calidad:</strong> Usa cargador de 2A+ para asegurar energía estable durante la grabación y subida</li>
                <li><strong>Gestión de Calor:</strong> Evita la exposición directa a la luz solar — el sobrecalentamiento puede activar la aceleración térmica o el apagado</li>
                <li><strong>Rendimiento de Almacenamiento:</strong> Usa tarjetas SD de alta calidad (Clase 10, UHS-I o mejor) para almacenamiento externo</li>
                <li><strong>Rendimiento de Red:</strong> Para subidas SMB, usa WiFi de 5GHz cuando esté disponible (velocidades de transferencia más rápidas)</li>
                <li><strong>Limpieza de Almacenamiento:</strong> Limpia periódicamente las grabaciones antiguas manualmente o habilita eliminar-después-de-subir</li>
            </ul>

            <h3>Diagnósticos Avanzados</h3>
            <p>Si los problemas persisten, verifica Android Logcat para mensajes de error detallados:</p>
            <ol>
                <li>Habilita Opciones de Desarrollador (Configuración → Acerca del Teléfono → Toca Número de Compilación 7 veces)</li>
                <li>Habilita Depuración USB (Configuración → Opciones de Desarrollador)</li>
                <li>Conecta a la computadora y ejecuta: <code>adb logcat -s DashCam:*</code></li>
                <li>Busca mensajes de error etiquetados con nombres de componentes (VideoRecorder, UploadManager, etc.)</li>
            </ol>
        </section>

        <hr>

        <section id="technical">
            <h2>Especificaciones Técnicas</h2>

            <h3>Codificación de Video</h3>
            <ul>
                <li><strong>Códec:</strong> H.264/AVC (contenedor MP4)</li>
                <li><strong>Velocidad de Fotogramas:</strong> 30 fps (fijo)</li>
                <li><strong>Resolución:</strong> 1280×720, 1920×1080 o 3840×2160 (dependiente del dispositivo)</li>
                <li><strong>Orientación:</strong> Horizontal (rotación de 90° para montaje de dashcam)</li>
                <li><strong>Audio:</strong> Códec AAC, incluido en MP4</li>
            </ul>

            <h3>Sistemas de Telemetría</h3>
            <ul>
                <li><strong>Proveedor GPS:</strong> Google Play Services Fused Location (actualizaciones de 1 segundo)</li>
                <li><strong>Formato SRT:</strong> Subtítulos SubRip con superposiciones posicionadas (superior-izquierda, inferior-izquierda, inferior-derecha)</li>
                <li><strong>Muestreo CSV:</strong> 10 Hz (intervalos de 100ms) para acelerómetro, giroscopio, magnetómetro, luz, presión, proximidad</li>
                <li><strong>Formato GPX:</strong> GPS Exchange Format 1.1 XML con puntos de pista y marcas de tiempo</li>
            </ul>

            <h3>Detección de Impactos</h3>
            <ul>
                <li><strong>Algoritmo:</strong> Magnitud de acelerómetro filtrado paso-bajo (alfa=0.8)</li>
                <li><strong>Umbrales:</strong> ALTA=1.5G (15 m/s²), MEDIA=2.0G (20 m/s²), BAJA=3.0G (30 m/s²)</li>
                <li><strong>Búfer:</strong> Búfer circular de 2 minutos (segmentos de 1 minuto), captura post-impacto de 10 segundos</li>
                <li><strong>Tasa de Actualización:</strong> ~20ms (SENSOR_DELAY_GAME)</li>
            </ul>

            <h3>Arquitectura de Almacenamiento</h3>
            <ul>
                <li><strong>Interna:</strong> API de File directa al directorio específico de la aplicación</li>
                <li><strong>Externa:</strong> Storage Access Framework (SAF) con persistencia de DocumentTree</li>
                <li><strong>FileAccessManager:</strong> Capa de abstracción unificada para APIs File y DocumentFile</li>
                <li><strong>Salida de Video:</strong> FileOutputOptions (interna), FileDescriptorOutputOptions (SAF externa)</li>
            </ul>

            <h3>Arquitectura de Subidas</h3>
            <ul>
                <li><strong>SMB/CIFS:</strong> Biblioteca jcifs-ng con resolución de nombres NetBIOS</li>
                <li><strong>Google Drive:</strong> API de Google Sign-In + Drive REST API v3 (multiparte <5MB, reanudable ≥5MB)</li>
                <li><strong>OneDrive:</strong> Microsoft Graph API v1.0 (simple <4MB, sesión reanudable ≥4MB)</li>
                <li><strong>Reintento:</strong> Android WorkManager con retroceso exponencial (máximo 5 intentos)</li>
                <li><strong>Cola:</strong> Procesamiento secuencial con seguimiento de progreso basado en StateFlow</li>
            </ul>

            <h3>Seguridad</h3>
            <ul>
                <li><strong>Tokens OAuth:</strong> Cifrados mediante EncryptedSharedPreferences + Android Keystore</li>
                <li><strong>Credenciales SMB:</strong> Cifradas mediante Android Keystore (respaldadas por hardware cuando está disponible)</li>
                <li><strong>Actualización de Tokens:</strong> Actualización automática 5 minutos antes de la expiración</li>
                <li><strong>Permisos:</strong> CAMERA, RECORD_AUDIO, ACCESS_FINE_LOCATION, INTERNET, WAKE_LOCK, FOREGROUND_SERVICE, ACCESS_NETWORK_STATE</li>
            </ul>

            <h3>Framework y Bibliotecas</h3>
            <ul>
                <li><strong>UI:</strong> Jetpack Compose (UI declarativa)</li>
                <li><strong>Cámara:</strong> CameraX (con respaldo de selector de calidad)</li>
                <li><strong>Preferencias:</strong> DataStore (Preferences + Proto)</li>
                <li><strong>Concurrencia:</strong> Kotlin Coroutines + Flow</li>
                <li><strong>Reproducción de Medios:</strong> ExoPlayer</li>
                <li><strong>Trabajo en Segundo Plano:</strong> WorkManager</li>
                <li><strong>SMB:</strong> jcifs-ng</li>
            </ul>

            <h3>Requisitos del Dispositivo</h3>
            <ul>
                <li><strong>Android Mínimo:</strong> 8.0 Oreo (API 26)</li>
                <li><strong>Android Objetivo:</strong> 14 (API 34)</li>
                <li><strong>Cámara:</strong> Cámara trasera requerida (cámara frontal no compatible)</li>
                <li><strong>Sensores:</strong> GPS, acelerómetro requeridos; giroscopio, magnetómetro, luz, presión, proximidad opcionales</li>
                <li><strong>Almacenamiento:</strong> Mínimo 8 GB recomendado (16+ GB para grabación extendida)</li>
            </ul>
        </section>

        <hr>

        <section id="limitations">
            <h2>Limitaciones Conocidas</h2>

            <h3>Limitaciones Actuales (Beta)</h3>
            <ul>
                <li><strong>Soporte de Emulador:</strong> Grabación de video deshabilitada en emuladores de Android (limitación de CameraX). El modo solo-telemetría funciona.</li>
                <li><strong>Compatibilidad de MediaMuxer:</strong> Puede fallar en algunos dispositivos en modo AUTO (respaldo: guarda solo el último segmento)</li>
                <li><strong>Archivos PER_TRIP Grandes:</strong> Viajes continuos extremadamente largos (4+ horas a 1080p) pueden exceder 20 GB — asegura almacenamiento adecuado</li>
                <li><strong>Permiso de Ubicación WiFi:</strong> Android 10+ requiere ACCESS_FINE_LOCATION para acceso a SSID (restricciones WiFi)</li>
            </ul>

            <h3>Consideraciones de Microsoft OneDrive</h3>
            <ul>
                <li><strong>Expiración de Secreto de Cliente:</strong> El secreto de cliente de Microsoft expira aproximadamente en octubre de 2026</li>
                <li><strong>Impacto:</strong> La aplicación requerirá actualización o implementación de servidor backend antes de la expiración</li>
                <li><strong>Mitigación:</strong> Los usuarios serán notificados con suficiente anticipación mediante actualización de la aplicación</li>
            </ul>

            <h3>Características Planificadas</h3>
            <ul>
                <li><strong>Gestión Térmica:</strong> Monitoreo de temperatura y aceleración de grabación (próxima prioridad)</li>
                <li><strong>Integración con Dropbox:</strong> Pendiente de demanda de usuarios</li>
                <li><strong>Pruebas Automatizadas:</strong> La infraestructura de pruebas existe pero las pruebas aún no se han implementado</li>
                <li><strong>Filtrado de Tipo de Archivo:</strong> UI para modo de subida TELEMETRY_ONLY (arquitectura completa)</li>
            </ul>
        </section>

        <hr>

        <section id="safety">
            <h2>Seguridad y Responsabilidad</h2>
            <p>DashCam asiste a los conductores — <strong>no</strong> es un sustituto de la conducción segura. Siempre sigue las leyes locales con respecto a la grabación en el automóvil.</p>
        </section>

        <hr>

        <section id="support">
            <h2>Soporte y Comentarios</h2>
            <p>Esta es una <strong>versión beta</strong> — estable para uso diario, con desarrollo activo continuo.</p>
            <ul>
                <li>Reporta problemas o sugerencias a través de la página de GitHub del proyecto.</li>
                <li>Incluye tu modelo de teléfono, versión de Android y una descripción breve del problema.</li>
            </ul>
            <p><strong>Gracias por usar DashCam. Conduce seguro — y graba de manera responsable.</strong></p>
        </section>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2025 ByteForge. Todos los derechos reservados.</p>
            <p>
                <a href="manual.html">Manual de Usuario</a> |
                <a href="eula.html">Términos de Uso</a> |
                <a href="license.html">Licencia</a> |
                <a href="privacy-policy.html">Política de Privacidad</a>
            </p>
        </div>
    </footer>
</body>
</html>
